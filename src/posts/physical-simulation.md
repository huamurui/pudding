---
icon: edit
date: 2025-09-21
title: 物理模拟
tags: ['物理模拟', 'web'] 
---

>可能... 是我最开始学编程，做小玩具的时候喜欢的想做的一些东西，今天想整理一下，顺便学一下怎么写数学公式，调调博客各种内容的样式。

##  Web 动画

Web 画图可以用一个个小元素拼，也可以用 canvas，但像物理模拟这种事情还是用 canvas 比较合适。  
而，除了画图，让画面动起来，物理模拟也还需要有时间的概念。  

这在 web 中有许多方式，古老的 setInterval 会按照传入的时间间隔去调用一个函数，这个函数自然可以是更新画面。  
而对于动画，专门的 requestAnimationFrame 会更合适，会在浏览器每次重绘之前调用传入的函数，传入的回调也会给一个时间戳的入参，外面写个变量记一下也能挺容易算出两次调用的时间间隔 $$\Delta t$$ 。而对回调函数的调用频率也会和设备刷新率相匹配，也许通常是 60Hz。总之，对于动画，用它就不用再考虑很多奇奇怪怪的问题了。  

```js
function draw(time) {
  /*
   更新画面
   ......
  */
  requestAnimationFrame(draw);
}
```

## 时间积分/时间离散/时间步进

上面提到的 web 中有关时间和动画 的 API 都是离散的，所以，一些物理模拟中的时间也一样要跟着是离散的。  
对于一般的运动模拟，通常关注 x, v, a 这几个物理量就足够了。

怎么做呢?

### 最简单的

$$x(t + \Delta t) = x(t) + v(t) \Delta t$$

$$v(t + \Delta t) = v(t) + a(t) \Delta t$$

这应该算最简单的方法了，简单到我甚至才知道它还有个专门名字，叫欧拉方法，知道它们有好多种，统称数值方法。

### Verlet 积分

最近又看到一个 Verlet 积分：

$$x(t+\Delta t) = 2x(t) - x(t-\Delta t) + a(t)\Delta t^2$$

还有带速度版本的：

$$x(t + \Delta t) = x(t) + v(t) \Delta t + \frac{1}{2} a(t) \Delta t^2$$

$$v(t + \Delta t) = v(t) + \frac{a(t) + a(t + \Delta t)}{2} \Delta t $$

>看起来它在计算位移时不仅考虑了 v 还同时考虑了 a，像泰勒展开多展开了几项，应该会更精确一些吧...  
>去查了查那些别的数值方法，这些东西长的都像是能用泰勒展开推出来的，一些更简单方便计算的式子...？  
>虽然我会觉得怀疑它们一开始是被用各种稀奇古怪的手段弄出来的。  

## 弹簧与碰撞

胡克定律  

$$F = -k \Delta x$$


弹性碰撞时的动量,能量守恒

$$m_1 v_1 + m_2 v_2 = m_1 v_1' + m_2 v_2'$$

$$\frac{1}{2} m_1 v_1^2 + \frac{1}{2} m_2 v_2^2 = \frac{1}{2} m_1 v_1'^2 + \frac{1}{2} m_2 v_2'^2$$

推导碰撞后的速度

$$v_1' = \frac{m_1 - m_2}{m_1 + m_2} v_1 + \frac{2 m_2}{m_1 + m_2} v_2$$

$$v_2' = \frac{2 m_1}{m_1 + m_2} v_1 + \frac{m_2 - m_1}{m_1 + m_2} v_2$$

最后推导的结果其实是，某种对称的，交换 `1` `2` 位置就是互相的式子。  
所以，对于 `1` 和 `2` 如果将当前想要求解速度的物体记为 `self` ，另一个物体记为 `other` ，最后的这两个式子其实是一个

$$v_{\text{self}}' = v_{\text{self}} + \frac{2 m_{\text{other}}}{m_{\text{self}} + m_{\text{other}}} (v_{\text{other}} - v_{\text{self}})$$


这只是一维，做成 2d 的也就是 x y 两个方向的分量一起算就好，公式也还是一样。

## 弹簧质点模型

最后，我想做那种软软弹弹的像果冻一样的效果  

...tobe continued
